<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="last-modified" content="2017-08-04 00:19:58 +0200">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- meta "search-domain" used for google site search function google_search() -->
    <meta name="search-domain" value="/swc-releases/2017.08/hg-novice">
    <link rel="stylesheet" type="text/css" href="../assets/css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/bootstrap-theme.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/lesson.css" />
    
    <link rel="shortcut icon" type="image/x-icon" href="/favicon-swc.ico" />
    
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
	<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
	<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	<![endif]-->
    <title>Version Control with Mercurial: Making Changes</title>
  </head>
  <body>
    <div class="container">
      
<nav class="navbar navbar-default">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      
      

      
      <a class="navbar-brand" href="../">Home</a>

    </div>
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">

	
        <li><a href="../conduct/">Code of Conduct</a></li>

	
        
        <li><a href="../setup/">Setup</a></li>
        <li class="dropdown">
          <a href="../" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Episodes <span class="caret"></span></a>
          <ul class="dropdown-menu">
            
            <li><a href="../01-basics/">Automated Version Control</a></li>
            
            <li><a href="../02-configuration/">Configuring Mercurial</a></li>
            
            <li><a href="../03-create-repo/">Creating a Repository</a></li>
            
            <li><a href="../04-tracking/">Tracking Changes to Files</a></li>
            
            <li><a href="../05-changes/">Making Changes</a></li>
            
            <li><a href="../06-history/">Exploring History</a></li>
            
            <li><a href="../07-revert/">Recovering Old Versions</a></li>
            
            <li><a href="../08-ignore/">Ignoring Things</a></li>
            
            <li><a href="../09-remote-repos/">Remote Repositories</a></li>
            
            <li><a href="../10-repo-clones/">Working with Clone Repositories</a></li>
            
            <li><a href="../11-collaboration/">Collaboration</a></li>
            
            <li><a href="../12-merges/">Merging Changes from Different Clones</a></li>
            
            <li><a href="../13-conflicts/">Merge Conflicts</a></li>
            
            <li><a href="../14-open/">Open Science</a></li>
            
            <li><a href="../15-licensing/">Licensing</a></li>
            
            <li><a href="../16-hosting/">Hosting</a></li>
            
	    <li role="separator" class="divider"></li>
            <li><a href="../aio/">All in one page (Beta)</a></li>
          </ul>
        </li>
	

	
	
        <li class="dropdown">
          <a href="../" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Extras <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../reference/">Reference</a></li>
            
            <li><a href="../about/">About</a></li>
            
            <li><a href="../extras/discuss.html">Discussion</a></li>
            
            <li><a href="../figures/">Figures</a></li>
            
            <li><a href="../guide/">Instructor Notes</a></li>
            
          </ul>
        </li>
	

	
        <li><a href="../license/">License</a></li>
	
	<li><a href="/edit/gh-pages/_episodes/05-changes.md">Improve this page <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></a></li>
	
      </ul>
      <form class="navbar-form navbar-right" role="search" id="search" onsubmit="google_search(); return false;">
        <div class="form-group">
          <input type="text" id="google-search" placeholder="Search..." aria-label="Google site search">
        </div>
      </form>
    </div>
  </div>
</nav>


<div class="row">
  <div class="col-md-1">
    <h3>
      
      <a href="../04-tracking/"><span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span><span class="sr-only">previous episode</span></a>
      
    </h3>
  </div>
  <div class="col-md-10">
    
    <h3 class="maintitle"><a href="../">Version Control with Mercurial</a></h3>
    
  </div>
  <div class="col-md-1">
    <h3>
      
      <a href="../06-history/"><span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span><span class="sr-only">next episode</span></a>
      
    </h3>
  </div>
</div>

<article>
<div class="row">
  <div class="col-md-1">
  </div>
  <div class="col-md-10">
    <h1 class="maintitle">Making Changes</h1>
  </div>
  <div class="col-md-1">
  </div>
</div>


<blockquote class="objectives">
  <h2>Overview</h2>

  <div class="row">
    <div class="col-md-3">
      <strong>Teaching:</strong> 10 min
      <br/>
      <strong>Exercises:</strong> 5 min
    </div>
    <div class="col-md-9">
      <strong>Questions</strong>
      <ul>
	
	<li><p>How can I change files in a repository?</p>
</li>
	
      </ul>
    </div>
  </div>

  <div class="row">
    <div class="col-md-3">
    </div>
    <div class="col-md-9">
      <strong>Objectives</strong>
      <ul>
	
	<li><p>Display the uncommitted changes that have been made to tracked files.</p>
</li>
	
	<li><p>Go through the modify-commit cycle for single and multiple files.</p>
</li>
	
      </ul>
    </div>
  </div>

</blockquote>

<p>Now suppose Susan adds more notes to the file.
(Again, we’ll edit with <code class="highlighter-rouge">nano</code> and then <code class="highlighter-rouge">cat</code> the file to show its contents;
you may use a different editor, and don’t need to <code class="highlighter-rouge">cat</code>.)</p>

<div class="bash highlighter-rouge"><pre class="highlight"><code>$ nano plan.txt
$ cat plan.txt
</code></pre>
</div>

<div class="output highlighter-rouge"><pre class="highlight"><code>Goal: Run NEMO everyday to forecast storm surge water levels

Need daily high resolution weather forcing from Environment Canada.
</code></pre>
</div>

<p>When we run <code class="highlighter-rouge">hg status</code> now,
it tells us that a file it already knows about has been modified:</p>

<div class="bash highlighter-rouge"><pre class="highlight"><code>$ hg status
</code></pre>
</div>

<div class="output highlighter-rouge"><pre class="highlight"><code>M plan.txt
</code></pre>
</div>

<p>The <code class="highlighter-rouge">M</code> at the beginning of the line means that Mercurial has noticed that
we have modified the <code class="highlighter-rouge">plan.txt</code> file.</p>

<p>We can double-check our work using <code class="highlighter-rouge">hg diff</code>,
which shows us the differences between the current state of the file and the
most recently committed version:</p>

<div class="bash highlighter-rouge"><pre class="highlight"><code>$ hg diff
</code></pre>
</div>

<div class="output highlighter-rouge"><pre class="highlight"><code><span class="gh">diff -r 1320339bbcae plan.txt
</span><span class="gd">--- a/plan.txt  Tue Jun 09 14:41:27 2015 +0200
</span><span class="gi">+++ b/plan.txt  Tue Jun 09 15:07:42 2015 +0200
</span><span class="gu">@@ -1,1 +1,3 @@
</span> Goal: Run NEMO everyday to forecast storm surge water levels
<span class="gi">+
+Need daily high resolution weather forcing from Environment Canada.
</span></code></pre>
</div>

<p>The output is cryptic because it is actually a series of commands for tools like
editors and <code class="highlighter-rouge">patch</code> telling them how to reconstruct one file given the other.
If we can break it down into pieces:</p>

<ol>
  <li>
    <p>The first line tells us that Mercurial is using the Unix <code class="highlighter-rouge">diff</code> command to
compare the last committed and new versions of the file.</p>
  </li>
  <li>The next two lines show us the time stamps of the 2 versions of the file
that are being compared.</li>
  <li>The remaining lines show us the actual differences and the lines on which
they occur.
In particular,
the <code class="highlighter-rouge">+</code> markers in the first column show where we are adding lines.</li>
</ol>

<p>Let’s commit our change:</p>

<div class="bash highlighter-rouge"><pre class="highlight"><code>$ hg commit -m "Add note about source for atmospheric forcing."
</code></pre>
</div>

<p>Checking our project’s status:</p>

<div class="bash highlighter-rouge"><pre class="highlight"><code>$ hg status
</code></pre>
</div>

<p>we get no output because all of the changes have been committed.
We can see our commits with <code class="highlighter-rouge">hg log</code>:</p>

<div class="bash highlighter-rouge"><pre class="highlight"><code>$ hg log
</code></pre>
</div>

<div class="output highlighter-rouge"><pre class="highlight"><code>changeset:   1:b31241913818
tag:         tip
user:        Susan Allen &lt;sallen@eos.ubc.ca&gt;
date:        Tue Jun 09 15:16:11 2015 +0200
summary:     Add note about source for atmospheric forcing.

changeset:   0:1320339bbcae
user:        Susan Allen &lt;sallen@eos.ubc.ca&gt;
date:        Tue Jun 09 14:41:27 2015 +0200
summary:     Starting to plan the daily NEMO forecast system.

</code></pre>
</div>

<blockquote class="callout">
  <h2 id="committing-only-some-of-the-changes">Committing Only Some of the Changes</h2>

  <p>Of course sometimes we may not want to commit everything at once.
For example,
suppose we’re adding a few citations to our supervisor’s work to our thesis.
We might want to commit those additions,
and the corresponding addition to the bibliography,
but <em>not</em> commit the work we’re doing on the conclusions
(which we haven’t finished yet).
To handle that,
simply do two
(or more)
separate commits,
listing the names of the files to be included in each commit in the <code class="highlighter-rouge">hg commit</code>
command:</p>

  <div class="bash highlighter-rouge"><pre class="highlight"><code>$ hg commit -m "Cite Sastri and Dower (2009)." methods.txt biblio.txt
...
&lt;later&gt;
...
$ hg commit conclusions.txt -m "Update conclusions re: phyto bloom timing mismatches."
</code></pre>
  </div>

  <p>Notice that the list of file names can come before or after the commit comment
in the <code class="highlighter-rouge">hg commit</code> command.</p>
</blockquote>

<p>Let’s add another line to the file for practice and to make our revision
history more interesting:</p>

<div class="bash highlighter-rouge"><pre class="highlight"><code>$ nano plan.txt
$ cat plan.txt
</code></pre>
</div>

<div class="output highlighter-rouge"><pre class="highlight"><code>Goal: Run NEMO everyday to forecast storm surge water levels

Need daily high resolution weather forcing from Environment Canada.
Also need daily average Fraser River flow from Environment Canada.
</code></pre>
</div>

<div class="bash highlighter-rouge"><pre class="highlight"><code>$ hg diff
</code></pre>
</div>

<div class="output highlighter-rouge"><pre class="highlight"><code><span class="gh">diff -r b31241913818 plan.txt
</span><span class="gd">--- a/plan.txt  Tue Jun 09 15:16:11 2015 +0200
</span><span class="gi">+++ b/plan.txt  Tue Jun 09 15:25:33 2015 +0200
</span><span class="gu">@@ -1,3 +1,4 @@
</span> Goal: Run NEMO everyday to forecast storm surge water levels

 Need daily high resolution weather forcing from Environment Canada.
<span class="gi">+Also need daily average Fraser River flow from Environment Canada.
</span></code></pre>
</div>

<p>So far, so good:
we’ve added one line to the end of the file
(shown with a <code class="highlighter-rouge">+</code> in the first column).
Now,
let’s commit our changes:</p>

<div class="bash highlighter-rouge"><pre class="highlight"><code>$ hg commit plan.txt -m "Add note about data source for Fraser River flow forcing."
</code></pre>
</div>

<p>and look at the history of what we’ve done so far:</p>

<div class="bash highlighter-rouge"><pre class="highlight"><code>$ hg log
</code></pre>
</div>

<div class="output highlighter-rouge"><pre class="highlight"><code>changeset:   2:2e15a7ee29c2
tag:         tip
user:        Susan Allen &lt;sallen@eos.ubc.ca&gt;
date:        Tue Jun 09 15:28:25 2015 +0200
summary:     Add note about data source for Fraser River flow forcing.

changeset:   1:b31241913818
user:        Susan Allen &lt;sallen@eos.ubc.ca&gt;
date:        Tue Jun 09 15:16:11 2015 +0200
summary:     Add note about source for atmospheric forcing.

changeset:   0:1320339bbcae
user:        Susan Allen &lt;sallen@eos.ubc.ca&gt;
date:        Tue Jun 09 14:41:27 2015 +0200
summary:     Starting to plan the daily NEMO forecast system.

</code></pre>
</div>

<blockquote class="challenge">
  <h2 id="bio-repository"><code class="highlighter-rouge">bio</code> Repository</h2>

  <p>Create a new Mercurial repository on your computer called <code class="highlighter-rouge">bio</code>.
Write a three-line biography for yourself in a file called <code class="highlighter-rouge">me.txt</code>,
commit your changes,
then modify one line,
add a fourth line,
and display the differences between the file’s updated state and its
original state.</p>
</blockquote>


<blockquote class="keypoints">
  <h2>Key Points</h2>
  <ul>
    
    <li><p><code class="highlighter-rouge">hg diff</code> displays differences between commits.</p>
</li>
    
    <li><p><code class="highlighter-rouge">hg log</code> shows the history of a repository.</p>
</li>
    
  </ul>
</blockquote>

</article>

<div class="row">
  <div class="col-md-1">
    <h3>
      
      <a href="../04-tracking/"><span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span><span class="sr-only">previous episode</span></a>
      
    </h3>
  </div>
  <div class="col-md-10">
    
  </div>
  <div class="col-md-1">
    <h3>
      
      <a href="../06-history/"><span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span><span class="sr-only">next episode</span></a>
      
    </h3>
  </div>
</div>


      
      
<footer>
  <div class="row">
    <div class="col-md-6" align="left">
      <h4>
	Copyright &copy; 2016–2017
	
	<a href="https://software-carpentry.org">Software Carpentry Foundation</a>
	
      </h4>
    </div>
    <div class="col-md-6" align="right">
      <h4>
	
	<a href="/edit/gh-pages/_episodes/05-changes.md">Edit on GitHub</a>
	
	/
	<a href="/blob/gh-pages/CONTRIBUTING.md">Contributing</a>
	/
	<a href="/">Source</a>
	/
	<a href="/blob/gh-pages/CITATION">Cite</a>
	/
	<a href="">Contact</a>
      </h4>
    </div>
  </div>
</footer>

      
    </div>
    
<script src="../assets/js/jquery.min.js"></script>
<script src="../assets/js/bootstrap.min.js"></script>
<script src="../assets/js/lesson.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-37305346-2', 'auto');
  ga('send', 'pageview');
</script>

  </body>
</html>
