<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="last-modified" content="2017-02-08 23:51:16 +0100">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- meta "search-domain" used for google site search function google_search() -->
    <meta name="search-domain" value="/swc-releases/2017.02/hg-novice">
    <link rel="stylesheet" type="text/css" href="../assets/css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/bootstrap-theme.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/lesson.css" />
    
    <link rel="shortcut icon" type="image/x-icon" href="/favicon-swc.ico" />
    
    
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
	<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
	<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	<![endif]-->
    <title>Version Control with Mercurial: Remote Repositories</title>
  </head>
  <body>
    <div class="container">
      <nav class="navbar navbar-default">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      
      
      <a href="https://software-carpentry.org" class="pull-left">
        <img class="navbar-logo" src="../assets/img/swc-icon-blue.svg" alt="Software Carpentry logo" />
      </a>
      

      
      <a class="navbar-brand" href="../">Home</a>

    </div>
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">

	
        <li><a href="../conduct/">Code of Conduct</a></li>

	
        
        <li><a href="../setup/">Setup</a></li>
        <li><a href="../reference/">Reference</a></li>
        <li class="dropdown">
          <a href="../" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Episodes <span class="caret"></span></a>
          <ul class="dropdown-menu">
            
            <li><a href="../01-basics/">Automated Version Control</a></li>
            
            <li><a href="../02-configuration/">Configuring Mercurial</a></li>
            
            <li><a href="../03-create-repo/">Creating a Repository</a></li>
            
            <li><a href="../04-tracking/">Tracking Changes to Files</a></li>
            
            <li><a href="../05-changes/">Making Changes</a></li>
            
            <li><a href="../06-history/">Exploring History</a></li>
            
            <li><a href="../07-revert/">Recovering Old Versions</a></li>
            
            <li><a href="../08-ignore/">Ignoring Things</a></li>
            
            <li><a href="../09-remote-repos/">Remote Repositories</a></li>
            
            <li><a href="../10-repo-clones/">Working with Clone Repositories</a></li>
            
            <li><a href="../11-collaboration/">Collaboration</a></li>
            
            <li><a href="../12-merges/">Merging Changes from Different Clones</a></li>
            
            <li><a href="../13-conflicts/">Merge Conflicts</a></li>
            
            <li><a href="../14-open/">Open Science</a></li>
            
            <li><a href="../15-licensing/">Licensing</a></li>
            
            <li><a href="../16-hosting/">Hosting</a></li>
            
          </ul>
        </li>
	

	
	
        <li class="dropdown">
          <a href="../" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Extras <span class="caret"></span></a>
          <ul class="dropdown-menu">
            
            <li><a href="../about/">About</a></li>
            
            <li><a href="../extras/discuss.html">Discussion</a></li>
            
            <li><a href="../figures/">Figures</a></li>
            
            <li><a href="../guide/">Instructor Notes</a></li>
            
          </ul>
        </li>
	

	
        <li><a href="../license/">License</a></li>
      </ul>
      <form class="navbar-form navbar-right" role="search" id="search" onsubmit="google_search(); return false;">
        <div class="form-group">
          <input type="text" id="google-search" placeholder="Search..." aria-label="Google site search">
        </div>
      </form>
    </div>
  </div>
</nav>





<div class="row">
  <div class="col-md-1">
    <h3>
      
      <a href="../08-ignore/"><span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span><span class="sr-only">previous episode</span></a>
      
    </h3>
  </div>
  <div class="col-md-10">
    
    <h3 class="maintitle"><a href="../">Version Control with Mercurial</a></h3>
    <h1 class="maintitle">Remote Repositories</h1>
    
  </div>
  <div class="col-md-1">
    <h3>
      
      <a href="../10-repo-clones/"><span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span><span class="sr-only">next episode</span></a>
      
    </h3>
  </div>
</div>


<blockquote class="objectives">
  <h2>Overview</h2>

  <div class="row">
    <div class="col-md-3">
      <strong>Teaching:</strong> 10 min
      <br/>
      <strong>Exercises:</strong> 5 min
    </div>
    <div class="col-md-9">
      <strong>Questions</strong>
      <ul>
	
	<li><p>How can I use Mercurial to store information on other machines?</p>
</li>
	
      </ul>
    </div>
  </div>

  <div class="row">
    <div class="col-md-3">
    </div>
    <div class="col-md-9">
      <strong>Objectives</strong>
      <ul>
	
	<li><p>Explain what remote repositories are and why they are useful.</p>
</li>
	
	<li><p>Explain what happens when a remote repository is cloned.</p>
</li>
	
	<li><p>Explain what happens when changes are pushed to or pulled from a remote repository.</p>
</li>
	
      </ul>
    </div>
  </div>

</blockquote>

<p>By now it should be obvious that version control is a powerful tool for
organizing our own work on our personal laptop or workstation.
It helps us keep track of what we did when,
gives us the ability to go back in time in our project’s history,
and can help us recover from mistakes.
But there’s more…</p>

<p>Mercurial allows us to move our work among copies
(clones, actually)
of our repositories on different machines.
We can use that capability to synchronize files and metadata between our laptop
and a lab workstation,
or between computers at home and at work,
or between our local computer and an HPC cluster,
etc.
While it is possible to move files and metadata between any two repository copies,
in practice it’s easiest to use one copy as a central hub.</p>

<p>The easiest way to set up a copy of a repo as a central hub that we can access
from anywhere that we have a network connection is to use a hosting service like
<a href="https://bitbucket.org/">Bitbucket</a>.</p>

<p>Let’s start by putting a copy of our Salish Sea forecast planning repo on Bitbucket.</p>

<p>Log in to the Bitbucket site,
then click on <code class="highlighter-rouge">Create repository</code> under the <code class="highlighter-rouge">Create</code> menu at the top of the page:</p>

<p><img src="../fig/bitbucket-create-repo-01.png" alt="Creating a Repository on Bitbucket (Step 1)" /></p>

<p>Name your repository <code class="highlighter-rouge">forecast</code> and then click <code class="highlighter-rouge">Create Repository</code>:</p>

<p><img src="../fig/bitbucket-create-repo-02.png" alt="Creating a Repository on Bitbucket (Step 2)" /></p>

<p>As soon as the repository is created,
Bitbucket displays a page with a URL and some information on how to configure
your local repository:</p>

<p><img src="../fig/bitbucket-create-repo-03.png" alt="Creating a Repository on Bitbucket (Step 3)" /></p>

<p>Select <code class="highlighter-rouge">I have an existing project</code>,
and use the commands shown to “push” the files and metadata from your local `
forecast` repo to the newly created one on Bitbucket:</p>

<div class="bash highlighter-rouge"><pre class="highlight"><code>$ cd forecast
$ hg push https://bitbucket.org/susan/forecast
</code></pre>
</div>

<p>The output from that <code class="highlighter-rouge">hg push</code> command should look like:</p>

<div class="output highlighter-rouge"><pre class="highlight"><code>pushing to https://bitbucket.org/susan/forecast
searching for changes
http authorization required for https://bitbucket.org/susan/forecast
realm: Bitbucket.org HTTP
user: susan
password:
remote: adding changesets
remote: adding manifests
remote: adding file changes
remote: added 3 changesets with 3 changes to 1 files
</code></pre>
</div>

<p>You will have to type your own Bitbucket user name and password.</p>

<p>The <code class="highlighter-rouge">hg push</code> command brought the repository on Bitbucket’s server up-to-date with the one on our own machine.
Our local and remote repositories are now in this state:</p>

<p><img src="../fig/bitbucket-repo-after-first-push.svg" alt="Bitbucket Repository After First Push" /></p>

<p>The next step is to connect the two repositories so that we don’t have to type
the URL every time we do something with Bitbucket.
We do this by making the Bitbucket repository a <strong>remote</strong> for the local repository.
You’ll need the URL for the Bitbucket repository,
which is the same URL from the <code class="highlighter-rouge">hg push</code> statement above.</p>

<p>Use the command:</p>

<div class="bash highlighter-rouge"><pre class="highlight"><code>$ hg config --local
</code></pre>
</div>

<p>to open your local repository’s configuration file in your editor.
You should see a template file that looks like:</p>

<div class="source highlighter-rouge"><pre class="highlight"><code># example repository config (see "hg help config" for more info)
[paths]
# path aliases to other clones of this repo in URLs or filesystem paths
# (see "hg help config.paths" for more info)
#
# default      = http://example.com/hg/example-repo
# default-push = ssh://jdoe@example.net/hg/jdoes-fork
# my-fork      = ssh://jdoe@example.net/hg/jdoes-fork
# my-clone     = /home/jdoe/jdoes-clone

[ui]
# name and email (local to this repository, optional), e.g.
# username = Jane Doe &lt;jdoe@example.com&gt;
</code></pre>
</div>

<p>Edit the file so that it has just 2 lines:</p>

<div class="source highlighter-rouge"><pre class="highlight"><code>[paths]
default = https://bitbucket.org/susan/forecast
</code></pre>
</div>

<p>Make sure to use the URL with your Bitbucket username in it rather than <code class="highlighter-rouge">susan</code>
(the one from the <code class="highlighter-rouge">hg push</code> command above).</p>

<p>Save the file.
It will automatically be stored in <code class="highlighter-rouge">forecast/.hg/hgrc</code>.</p>

<blockquote class="callout">
  <h2 id="hg-unknown-command-config">hg: unknown command ‘config’</h2>

  <p>If your computer responds to the <code class="highlighter-rouge">hg config --local</code> command with</p>

  <div class="output highlighter-rouge"><pre class="highlight"><code>hg: unknown command 'config'
</code></pre>
  </div>

  <p>it means that you are using a version of Mercurial older than 3.0 that
doesn’t have the <code class="highlighter-rouge">hg config</code> command.</p>

  <p>You will have to create your local repository’s configuration file from scratch.
Use:</p>

  <div class="bash highlighter-rouge"><pre class="highlight"><code>nano .hg/hgrc
</code></pre>
  </div>

  <p>to create the appropriately named empty file and then type in the 2 lines
above.</p>
</blockquote>

<p>We can check that the command has worked by running <code class="highlighter-rouge">hg paths</code>:</p>

<div class="bash highlighter-rouge"><pre class="highlight"><code>$ hg paths
</code></pre>
</div>

<div class="output highlighter-rouge"><pre class="highlight"><code>default = https://bitbucket.org/susan/forecast
</code></pre>
</div>

<p>Now that the default path is set up, we won’t need to specify the
target URL when we run <code class="highlighter-rouge">hg push</code> in the future; running <code class="highlighter-rouge">hg push</code>
will automatically push the changes from our local repository
to the repository on Bitbucket:</p>

<div class="bash highlighter-rouge"><pre class="highlight"><code>$ hg push
</code></pre>
</div>

<div class="output highlighter-rouge"><pre class="highlight"><code>pushing to https://bitbucket.org/susan/forecast
searching for changes
http authorization required for https://bitbucket.org/susan/forecast
realm: Bitbucket.org HTTP
user: susan
password:
no changes found
</code></pre>
</div>

<p>As before,
you will have to type your own Bitbucket user name and password.</p>

<p>This push has no effect because the two repositories are already synchronized.</p>

<p>We can pull changes from the remote repository to the local one as well:</p>

<div class="bash highlighter-rouge"><pre class="highlight"><code>$ hg pull
</code></pre>
</div>

<div class="output highlighter-rouge"><pre class="highlight"><code>pulling from https://bitbucket.org/susan/forecast
searching for changes
http authorization required for https://bitbucket.org/susan/forecast
realm: Bitbucket.org HTTP
user: susan
password:
no changes found
</code></pre>
</div>

<p>Pulling also has no effect in this case because the two repositories are already synchronized.
If we had pushed some changes to the repository on Bitbucket from a clone on another machine,
though,
this command would download them to our local repository.</p>

<blockquote class="challenge">
  <h2 id="bitbucket-timestamp">Bitbucket Timestamp</h2>

  <p>Create a repository on Bitbucket,
clone it,
add a file,
push those changes to Bitbucket.
Look at the <strong>timestamp</strong> of the change on Bitbucket.
How does Bitbucket record times, and why?</p>
</blockquote>

<blockquote class="callout">
  <h2 id="using-ssh-key-authentication">Using ssh Key Authentication</h2>

  <p>Typing your user name and password every time that you interact with
Bitbucket is really tedious.
There is an alternative mechanism based on a pair of ‘ssh’ encryption keys
that you can generate for yourself.
Getting that set up is a distraction from the topics of this workshop,
but after the workshop you should read the Bitbucket
<a href="https://confluence.atlassian.com/bitbucket/set-up-ssh-for-mercurial-728138122.html">Setting up SSH for Mercurial</a>
documentation on your own and set up ssh keys for yourself.</p>
</blockquote>

<blockquote class="keypoints">
  <h2>Key Points</h2>
  <ul>
    
    <li><p>Use <code class="highlighter-rouge">hg push</code> to push changes to remote repositories.</p>
</li>
    
    <li><p>Use <code class="highlighter-rouge">hg pull</code> to pull changes from remote repositories.</p>
</li>
    
  </ul>
</blockquote>





<div class="row">
  <div class="col-md-1">
    <h3>
      
      <a href="../08-ignore/"><span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span><span class="sr-only">previous episode</span></a>
      
    </h3>
  </div>
  <div class="col-md-10">
    
  </div>
  <div class="col-md-1">
    <h3>
      
      <a href="../10-repo-clones/"><span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span><span class="sr-only">next episode</span></a>
      
    </h3>
  </div>
</div>


      
      <footer>
  <div class="row">
    <div class="col-md-6" align="left">
      <h4>
	Copyright &copy; 2016
	<a href="https://software-carpentry.org">Software Carpentry Foundation</a>
	
      </h4>
    </div>
    <div class="col-md-6" align="right">
      <h4>
	<a href="/">Source</a>
	/
	<a href="/blob/gh-pages/CONTRIBUTING.md">Contributing</a>
	/
	<a href="mailto:lessons@software-carpentry.org">Contact</a>
      </h4>
    </div>
  </div>
</footer>

      
    </div>
    <script src="../assets/js/jquery.min.js"></script>
<script src="../assets/js/bootstrap.min.js"></script>
<script src="../assets/js/lesson.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-37305346-2', 'auto');
  ga('send', 'pageview');
</script>

  </body>
</html>
